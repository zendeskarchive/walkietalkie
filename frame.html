<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Comm test</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script charset="utf-8" src="/walkietalkie.js" type="text/javascript"></script>
    <script charset="utf-8" src="/js/demo.js" type="text/javascript"></script>
    <script charset="utf-8" src="/js/democanvas.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/css/demo.css" />
  </head>
  <body>
    <canvas width="465" height="300"></canvas>
    <script type="text/javascript">
      var talkie = new WalkieTalkie();
      var canvas = new DemoCanvas('canvas')
      var query = parseQuery();
      var which = query.which;
      var target = talkie.get('target');

      talkie.receive("draw", function(message) {
        if (target == 'both' || target == which) {
          canvas.drawDot(message.data);
        }
      });

      talkie.receive("clear", function(message) {
        canvas.clearCanvas();
      });

      talkie.watch("target", function(property) {
        target = property.data;
      });

    </script>
  </body>
</html>


